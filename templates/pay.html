
<!doctype html>
<html lang="hr">
<head>
  <meta charset="utf-8"><title>Plaćanje</title>
  <script src="https://js.stripe.com/v3/"></script>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <style> body { background:#071029; color:#fff; } .card{margin:30px auto; max-width:800px;} </style>
</head>
<body>
  <div class="card p-4">
    <h3>Aktivacija za MAC: {{mac}}</h3>
    <p>Izaberi plan:</p>

    <div class="mb-3">
      <button class="btn btn-success" id="pay-lifetime">Lifetime - {{ "%.2f"|format(prices['lifetime']/100) }} €</button>
      <button class="btn btn-primary" id="pay-year">1 godina - {{ "%.2f"|format(prices['year']/100) }} €</button>
    </div>

    <p>Na uspjeh ćeš biti preusmjeren na Stripe checkout.</p>
    <a class="btn btn-secondary" href="/">Povratak</a>
  </div>

<script>
const publicKey = "{{ public_key }}";
async function createSession(plan) {
  const res = await fetch('/create-checkout-session', {
    method: 'POST',
    headers: { 'Content-Type':'application/json' },
    body: JSON.stringify({ mac: "{{mac}}", plan: plan })
  });
  const data = await res.json();
  if (data.url) {
    window.location = data.url;
  } else {
    alert("Greška: " + (data.error || "nepoznato"));
  }
}

document.getElementById('pay-lifetime').onclick = () => createSession('lifetime');
document.getElementById('pay-year').onclick = () => createSession('year');
</script>
</body>
</html>
